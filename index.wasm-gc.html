<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="shortcut icon" href="data:," />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Moonbit exn via js FFI</title>
  <style>
  </style>
</head>

<body>
  <script type="module">
    import { wasmImportObject } from "./web-api.mjs";

    const imports = {
      "moonbit:ffi": {
        "make_closure": (funcref, closure) => funcref.bind(null, closure)
      },
      console: {
        log: (msg) => console.log(msg),
      },
      ...wasmImportObject
    };

    const main = await WebAssembly.instantiateStreaming(fetch("target/wasm-gc/release/build/js_exn_mbt.wasm"), imports,
      {
        builtins: ["js-string"],
        importedStringConstants: "_",
      }
    );
    main.instance.exports._start();
  </script>
</body>

</html>